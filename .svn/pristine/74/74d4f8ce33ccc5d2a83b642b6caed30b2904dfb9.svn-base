define(["jquery","jquery.fileupload","jquery.iframe-transport"],function(a){"use strict";function b(){function b(b,d){var e=d.files[0],f=e.name;c(f)?(a("#continue_btn").attr({disabled:"disabled"}),a("#resourcePath").hide(),h=a("#profileImage").attr("src"),a("#ajaxLoadingWait").removeClass("no-display"),a("#profileImage").addClass("no-display"),d.submit()):alert("Please select a PNG, JPG or GIF image file.")}function c(a){var b="jpg|jpeg|png|gif",c=new RegExp(b,"i");return c.test(a)}function d(b,c){try{var d=c.result;if(d=d.substring(d.indexOf("{"),d.lastIndexOf("}")+1),d=a.parseJSON(d),0!==d.responseHeader.status)alert(d.response.message),a("#profileImage").attr("src",h),a("#profileImage").removeClass("no-display"),a("#ajaxLoadingWait").addClass("no-display");else{var e=d.response;e.uri?g?g(e):(a("#profileImage").attr("src",e.uri),a("#profileImage").data("default-image","false"),a("#profileImage").removeClass("no-display"),a("#ajaxLoadingWait").addClass("no-display")):(a("#profileImage").attr("src",h),a("#profileImage").removeClass("no-display"),a("#ajaxLoadingWait").addClass("no-display"))}a("#continue_btn").removeAttr("disabled"),a("#resourcePath").show()}catch(f){alert("Failure in uploading profile picture. Please try again."),a("#continue_btn").removeAttr("disabled"),a("#resourcePath").show(),a("#profileImage").attr("src",h),a("#profileImage").removeClass("no-display"),a("#ajaxLoadingWait").addClass("no-display")}}function e(a,b){}function f(c){g=c;var f=a("#frm_imageupload");a("#btn_coveredit_apply").addClass("disabled"),f.fileupload({dataType:"html",add:b,done:d,progress:e})}var g=null,h="";this.initImageUploader=f}return new b});